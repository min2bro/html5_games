<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraction Bridge | NY Times Style</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Source Sans 3', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .game-container {
            background: white;
            border-radius: 4px;
            padding: 40px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
            max-width: 700px;
            width: 100%;
            border: 1px solid #eaeaea;
            position: relative;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .header h1 {
            font-family: 'Lora', serif;
            font-weight: 700;
            color: #121212;
            margin: 0;
            font-size: 2.4rem;
            letter-spacing: -0.5px;
            margin-bottom: 5px;
        }
        
        .instruction {
            font-size: 1.1rem;
            color: #666;
            margin-top: 15px;
            font-style: italic;
        }
        
        .score-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 25px;
            font-weight: 600;
            font-size: 1rem;
            color: #444;
        }
        
        .score-box {
            background: #f8f8f8;
            padding: 8px 25px;
            border-radius: 30px;
            border: 1px solid #e2e2e2;
        }
        
        .bridge-container {
            position: relative;
            height: 200px;
            margin: 30px 0 40px;
            background: #f8f8f8;
            border-radius: 8px;
            padding: 30px;
            border: 1px solid #eaeaea;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .bridge-row {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            position: relative;
            height: 60px;
            width: 100%;
        }
        
        .point {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            z-index: 10;
            position: relative;
            border: 2px solid #333;
        }
        
        .pole {
            height: 24px;
            background: #0a5e8c;
            border-radius: 4px;
            margin: 0 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.95rem;
            min-width: 65px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }
        
        .pole:hover {
            background: #094b70;
        }
        
        .gap {
            height: 24px;
            background: white;
            border: 2px dashed #bbb;
            border-radius: 4px;
            margin: 0 10px;
            min-width: 85px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .gap.highlight {
            background: #f0f7ff;
            border-color: #0a5e8c;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { border-color: #0a5e8c; }
            50% { border-color: #4a9ed8; }
            100% { border-color: #0a5e8c; }
        }
        
        .choices {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin: 40px 0 30px;
            flex-wrap: wrap;
        }
        
        .choice {
            padding: 14px 28px;
            background: white;
            color: #0a5e8c;
            border: 1.5px solid #0a5e8c;
            border-radius: 4px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .choice:hover {
            background: #f0f7ff;
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        }
        
        .choice.correct {
            background: #0a5e8c;
            color: white;
            border-color: #0a5e8c;
        }
        
        .choice.incorrect {
            background: #f9f9f9;
            color: #999;
            border-color: #e2e2e2;
        }
        
        .message-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .message {
            text-align: center;
            font-size: 1.15rem;
            font-weight: 600;
            min-height: 30px;
            padding: 0 20px;
        }
        
        .message.correct {
            color: #0a5e8c;
        }
        
        .message.incorrect {
            color: #c33;
        }
        
        .next-button {
            background: #0a5e8c;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .next-button:hover {
            background: #094b70;
            transform: scale(1.05);
        }
        
        .progress {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin: 30px 0 25px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: #0a5e8c;
            transition: width 0.5s ease;
        }
        
        .game-complete {
            text-align: center;
            padding: 30px 20px;
        }
        
        .game-complete h2 {
            font-family: 'Lora', serif;
            font-size: 2.2rem;
            margin-bottom: 20px;
            color: #0a5e8c;
        }
        
        .final-score {
            font-size: 1.4rem;
            margin: 30px 0;
            color: #333;
            font-weight: 600;
        }
        
        @media (max-width: 600px) {
            .game-container {
                padding: 25px 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .choices {
                gap: 10px;
            }
            
            .choice {
                padding: 12px 20px;
                font-size: 0.95rem;
            }
            
            .bridge-container {
                padding: 20px 15px;
            }
            
            .pole, .gap {
                min-width: 50px;
                font-size: 0.85rem;
                margin: 0 6px;
            }
            
            .message-container {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>Fraction Bridge</h1>
            <p class="instruction">Select the fraction that completes the bridge to make 1 whole</p>
            
            <div class="score-container">
                <div class="score-box">Score: <span id="score">0</span></div>
                <div class="score-box">Level: <span id="level">1</span>/<span id="total">5</span></div>
            </div>
        </div>

        <div class="progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="bridge-container">
            <div class="bridge-row">
                <div class="point">A</div>
                <div class="pole" data-fraction="1/6">1/6</div>
                <div class="gap highlight" id="gap1">?</div>
                <div class="pole" data-fraction="3/6">3/6</div>
                <div class="point">B</div>
            </div>
        </div>

        <div class="message-container">
            <div class="message" id="message">Combine the fractions to complete the bridge</div>
            <button class="next-button" id="nextButton">→</button>
        </div>

        <div class="choices" id="choices">
            <!-- Choices will be populated by JavaScript -->
        </div>
    </div>

    <script>
        class FractionBridgeGame {
            constructor() {
                this.score = 0;
                this.currentLevel = 0;
                this.levels = [
                    {
                        poles: ['1/6', '3/6'],
                        gap: '2/6',
                        choices: ['1/6', '2/6', '3/6', '4/6'],
                        message: 'Combine the fractions to make 1 whole'
                    },
                    {
                        poles: ['2/8', '4/8'],
                        gap: '2/8',
                        choices: ['1/8', '2/8', '3/8', '4/8'],
                        message: 'What fraction completes the bridge?'
                    },
                    {
                        poles: ['1/4', '1/3'],
                        gap: '5/12',
                        choices: ['1/6', '5/12', '1/3', '1/4'],
                        message: 'Find the fraction that completes the bridge'
                    },
                    {
                        poles: ['1/2', '1/6'],
                        gap: '1/3',
                        choices: ['1/3', '1/4', '1/5', '2/6'],
                        message: 'Select the missing piece'
                    },
                    {
                        poles: ['3/5', '0'],
                        gap: '2/5',
                        choices: ['1/5', '2/5', '3/5', '4/5'],
                        message: 'Final challenge! Find the correct fraction'
                    }
                ];

                this.init();
            }

            init() {
                this.updateScore();
                this.loadLevel();
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.getElementById('nextButton').addEventListener('click', () => {
                    this.nextLevel();
                });
            }

            loadLevel() {
                if (this.currentLevel >= this.levels.length) {
                    this.showGameComplete();
                    return;
                }

                const level = this.levels[this.currentLevel];
                this.currentAnswer = level.gap;

                // Update poles
                const poles = document.querySelectorAll('.pole');
                poles[0].textContent = level.poles[0];
                poles[1].textContent = level.poles[1];

                // Clear gap
                const gap = document.getElementById('gap1');
                gap.textContent = '?';
                gap.className = 'gap highlight';
                gap.style.background = '';
                gap.style.color = '';

                // Create choices
                this.createChoices(level.choices);

                // Update message
                document.getElementById('message').textContent = level.message;
                document.getElementById('message').className = 'message';

                // Hide next button
                document.getElementById('nextButton').style.display = 'none';

                // Update progress
                this.updateProgress();
                
                // Update level display
                document.getElementById('level').textContent = this.currentLevel + 1;
            }

            createChoices(choices) {
                const choicesContainer = document.getElementById('choices');
                choicesContainer.innerHTML = '';

                // Shuffle choices to make game more engaging
                const shuffled = [...choices].sort(() => Math.random() - 0.5);
                
                shuffled.forEach(choice => {
                    const button = document.createElement('button');
                    button.className = 'choice';
                    button.textContent = choice;
                    button.addEventListener('click', () => this.checkAnswer(choice));
                    choicesContainer.appendChild(button);
                });
            }

            checkAnswer(selectedAnswer) {
                const isCorrect = this.isFractionCorrect(selectedAnswer);

                if (isCorrect) {
                    this.score++;
                    this.showCorrectAnswer(selectedAnswer);
                } else {
                    this.showIncorrectAnswer(selectedAnswer);
                }

                this.updateScore();
            }

            isFractionCorrect(selectedAnswer) {
                // Get the fraction values from the poles and selected answer
                const pole1 = this.parseFraction(document.querySelectorAll('.pole')[0].textContent);
                const pole2 = this.parseFraction(document.querySelectorAll('.pole')[1].textContent);
                const gap = this.parseFraction(selectedAnswer);
                
                // Calculate total value
                const total = this.addFractions(
                    this.addFractions(pole1, pole2),
                    gap
                );
                
                // Check if total equals 1 (1/1)
                return total.numerator === 1 && total.denominator === 1;
            }

            parseFraction(fractionString) {
                // Handle whole numbers
                if (!fractionString.includes('/')) {
                    return {
                        numerator: parseInt(fractionString),
                        denominator: 1
                    };
                }
                
                const [numerator, denominator] = fractionString.split('/');
                return {
                    numerator: parseInt(numerator),
                    denominator: parseInt(denominator)
                };
            }

            addFractions(frac1, frac2) {
                // Find common denominator
                const commonDenominator = frac1.denominator * frac2.denominator;
                
                // Convert numerators
                const num1 = frac1.numerator * frac2.denominator;
                const num2 = frac2.numerator * frac1.denominator;
                
                // Calculate sum
                const numeratorSum = num1 + num2;
                
                // Simplify the fraction
                return this.simplifyFraction({
                    numerator: numeratorSum,
                    denominator: commonDenominator
                });
            }

            simplifyFraction(fraction) {
                // Find greatest common divisor
                const gcd = this.greatestCommonDivisor(fraction.numerator, fraction.denominator);
                
                return {
                    numerator: fraction.numerator / gcd,
                    denominator: fraction.denominator / gcd
                };
            }

            greatestCommonDivisor(a, b) {
                return b === 0 ? a : this.greatestCommonDivisor(b, a % b);
            }

            showCorrectAnswer(selectedAnswer) {
                const gap = document.getElementById('gap1');
                gap.textContent = selectedAnswer;
                gap.className = 'gap';
                gap.style.background = '#0a5e8c';
                gap.style.color = 'white';

                const message = document.getElementById('message');
                message.textContent = '✓ Correct! The bridge is complete!';
                message.className = 'message correct';

                // Highlight correct choice
                const choices = document.querySelectorAll('.choice');
                choices.forEach(choice => {
                    if (choice.textContent === selectedAnswer) {
                        choice.className = 'choice correct';
                    }
                    choice.disabled = true;
                });

                document.getElementById('nextButton').style.display = 'flex';
            }

            showIncorrectAnswer(selectedAnswer) {
                const message = document.getElementById('message');
                message.textContent = 'Not quite. Try again.';
                message.className = 'message incorrect';

                // Mark the incorrect choice
                const choices = document.querySelectorAll('.choice');
                choices.forEach(choice => {
                    if (choice.textContent === selectedAnswer) {
                        choice.className = 'choice incorrect';
                    }
                });
            }

            nextLevel() {
                this.currentLevel++;
                this.loadLevel();
            }

            updateScore() {
                document.getElementById('score').textContent = this.score;
            }

            updateProgress() {
                const progress = ((this.currentLevel) / this.levels.length) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
            }

            showGameComplete() {
                const gameContainer = document.querySelector('.game-container');
                gameContainer.innerHTML = `
                    <div class="header">
                        <h1>Fraction Bridge</h1>
                    </div>
                    <div class="game-complete">
                        <h2>Bridge Completed!</h2>
                        <div class="final-score">Final Score: ${this.score} out of ${this.levels.length}</div>
                        <p>${this.score === this.levels.length ? 
                            'Perfect! You mastered fraction bridges!' : 
                            'Great job! You understand fractions well!'}</p>
                        <button class="next-button" onclick="location.reload()">↻</button>
                    </div>
                `;
            }
        }

        // Start the game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Set total levels
            document.getElementById('total').textContent = '5';
            new FractionBridgeGame();
        });
    </script>
</body>
</html>